'''
爬出来的oid数据转成十六进制形式
'''
testdata = ['1','2','840','113549','2','5']
data = ['2.5.29.37.0', '2.23.133.8.3', '1.3.6.1.4.1.311.20.2.1', '1.3.6.1.5.5.7.3.2', '1.3.6.1.5.5.7.3.3', '1.3.6.1.4.1.311.20.1', '1.3.6.1.4.1.311.10.5.1', '1.3.6.1.4.1.311.21.19', '1.3.6.1.4.1.311.10.3.30', '1.3.6.1.4.1.311.80.1', '1.3.6.1.4.1.311.10.3.12', '1.3.6.1.4.1.311.64.1.1', '1.3.6.1.4.1.311.76.5.1', '1.3.6.1.4.1.311.61.4.1', '1.3.6.1.4.1.311.10.3.8', '1.3.6.1.4.1.311.10.3.4', '2.23.133.8.1', '1.3.6.1.4.1.311.10.3.4.1', '1.3.6.1.4.1.311.61.5.1', '1.3.6.1.5.5.7.3.5', '1.3.6.1.5.5.8.2.2', '1.3.6.1.5.5.7.3.6', '1.3.6.1.5.5.7.3.7', '1.3.6.1.5.2.3.5', '1.3.6.1.4.1.311.61.1.1', '1.3.6.1.4.1.311.10.6.1', '1.3.6.1.4.1.311.10.3.11', '1.3.6.1.4.1.311.21.6', '1.3.6.1.4.1.311.10.6.2', '1.3.6.1.4.1.311.10.3.13', '1.3.6.1.4.1.311.76.8.1', '1.3.6.1.4.1.311.10.3.2', '1.3.6.1.4.1.311.10.3.1', '1.3.6.1.5.5.7.3.9', '1.3.6.1.4.1.311.10.3.7', '2.23.133.8.2', '1.3.6.1.4.1.311.10.3.27', '1.3.6.1.4.1.311.21.5', '1.3.6.1.4.1.311.10.3.22', '1.3.6.1.4.1.311.10.3.24', '1.3.6.1.4.1.311.10.3.10', '1.3.6.1.4.311.54.1.2', '1.3.6.1.4.1.311.10.3.19', '1.3.6.1.4.1.311.10.3.9', '1.3.6.1.5.5.7.3.4', '1.3.6.1.5.5.7.3.1', '1.3.6.1.4.1.311.20.2.2', '1.3.6.1.4.1.311.2.6.2', '1.3.6.1.4.1.311.2.6.1', '1.3.6.1.5.5.7.3.8', '1.3.6.1.4.1.311.10.3.5.1', '1.3.6.1.4.1.311.10.3.39', '1.3.6.1.4.1.311.10.3.5', '1.3.6.1.4.1.311.10.3.20', '1.3.6.1.4.1.311.10.3.21', '1.3.6.1.4.1.311.10.3.26', '1.3.6.1.4.1.311.76.3.1', '1.3.6.1.4.1.311.10.3.6', '1.3.6.1.4.1.311.10.3.23', '1.3.6.1.4.1.311.10.3.25', '1.3.6.1.4.1.311.76.6.1',  '1.3.6.1.4.1.311.21.1', '1.3.6.1.4.1.311.21.2', '1.3.6.1.4.1.311.21.3', '1.3.6.1.4.1.311.21.4', '1.3.6.1.4.1.311.21.5', '1.3.6.1.4.1.311.21.6', '1.3.6.1.4.1.311.21.7', '1.3.6.1.4.1.311.21.8', '1.3.6.1.4.1.311.21.9', '1.3.6.1.4.1.311.21.10', '1.3.6.1.4.1.311.21.11', '1.3.6.1.4.1.311.21.12', '1.3.6.1.4.1.311.21.13', '1.3.6.1.4.1.311.21.14', '1.3.6.1.4.1.311.21.15', '1.3.6.1.4.1.311.21.16', '1.3.6.1.4.1.311.21.17', '1.3.6.1.4.1.311.21.19', '1.3.6.1.4.1.311.21.20', '1.3.6.1.4.1.311.21.21', '1.3.6.1.4.1.311.21.22', '1.3.6.1.4.1.311.21.25', '2.5.29.14', '2.5.29.15', '2.5.29.16', '2.5.29.18', '2.5.29.19', '2.5.29.20', '2.5.29.21', '2.5.29.24', '2.5.29.27', '2.5.29.29', '2.5.29.31', '2.5.29.35', '2.5.29.19', '2.5.29.35', '2.5.29.32', '2.5.29.31', '2.5.29.46', '2.5.29.8', '2.5.29.15', '2.5.29.30', '2.5.29.36', '2.5.29.33', '2.5.29.16', '2.5.29.17', '2.5.29.9', '2.5.29.14']
def tranBignum(a):
    '''
    用于转换大于128的oid数
    :param a: 大于128的oid数
    :return: 转换后的列表 注意此时的是还未加128的数据
    '''
    lst1 = []
    lst1.append(a % 128)
    if ((a - (a % 128)) / 128) < 128:
        lst1.append(((a - (a % 128)) / 128))
    else:
        lst1.append(((a - (a % 128)) / 128) % 128)
        lst1.append((((a - (a % 128)) / 128) - ((a - (a % 128)) / 128) % 128) / 128)
    lst1.reverse()
    finalst = [int(i) + 128 for i in lst1[0:len(lst1) - 1]]
    finalst.append(lst1[-1])
    return finalst

def oidtohex(testdata):
    '''
    :param testdata: 需要进行转换的oid
    :return: 返回转换好的数据
    '''
    after_tran_oid = []
    first_level = int(testdata[0])*40 + int(testdata[1])#根据oid编码规则 第一位×40 加第二位
    after_tran_oid.append(first_level)#将第一级oid转换完成后存入列表
    for oid in testdata[2:]:
        if int(oid) < 128:#判断oid的大小，如果比128小，可以直接转换，否则就需要oid转换规则进行转换
            tran_oid = int(oid)
            after_tran_oid.append(tran_oid)
            pass
        else:
            l = tranBignum(int(oid))
            for i in l:
                after_tran_oid.append(int(i))
    return after_tran_oid

def tranoid(list):
    '''
    :param list: 待转换的oid列表
    :return:转换后的十六进制oid编码
    '''
    dec_lst = []
    finale_oid_hex_lst = []
    final_oid_lst = []
    middle = []
    for item in list:
        midlist = item.split('.')
        l = oidtohex(midlist)
        dec_lst = [hex(int(i)) for i in l]
        finale_oid_hex_lst.append(dec_lst)
    # print(finale_oid_hex_lst)
    for lst in finale_oid_hex_lst:
        middle = [i[2:4] for i in lst]
        final_oid_lst.append(middle)
    return final_oid_lst
    pass

